@using System
@using System.Collections.Generic
@using System.Linq
@using Microsoft.AspNetCore.Components
@using Cloud_In_A_Box.Components
@using Cloud_In_A_Box.Components.Models


<h1>Sample Tree</h1>

<p>Tree</p>

<div class="input-group mb-3">
    <div class="input-group-prepend">
        <span class="input-group-text" id="basic-addon1">Selected Item</span>
    </div>
    <input type="text" class="form-control"
           aria-label="SelectedText" aria-describedby="basic-addon1"
           bind=@_selectedNode.Text />
</div>
<div class="input-group mb-3">
    <input type="text" class="form-control"
           aria-label="ActionText" aria-describedby="basic-addon2"
           value="@_logText" />
</div>

@functions {

    private UiTreeNode<string> _selectedNode { get; set; } = new UiTreeNode<string>();
    private string _logText;

    private async Task<bool> OnExpand(int Id)
    {
        System.Console.WriteLine("Expanded " + Id);
        return await Task.FromResult(true);
    }

    private async Task<bool> OnCollapse(int Id)
    {
        System.Console.WriteLine("Un Expanded " + Id);
        return await Task.FromResult(true);
    }

    private void OnSelectionChanged<T>(UIMouseEventArgs e, UiTreeNode<T> node)
    {
        if (node is UiTreeNode<string>)
        {
            _selectedNode.IsSelected = false;
            _selectedNode = node as UiTreeNode<string>;
        }
        StateHasChanged();
    }

    protected override async Task OnInitAsync()
    {

    }

    private async Task<List<UiTreeNode<string>>> LoadNodes(int? ParentId = null)
    {
        return new List<UiTreeNode<string>>(){
            new UiTreeNode<string>() { Text = "Node 1", Children = new List<UiTreeNode<string>>()
    {
                    new UiTreeNode<string>() { Text = "ChildNode 1"},
                    new UiTreeNode<string>() { Text = "ChildNode 2"},
                    new UiTreeNode<string>() { Text = "ChildNode 3"},
                    new UiTreeNode<string>() { Text = "ChildNode 4", Children = new List<UiTreeNode<string>>()
        {
                        new UiTreeNode<string>() { Text = "Nested ChildNode 1"},
                        new UiTreeNode<string>() { Text = "Nested ChildNode 2"},
                        new UiTreeNode<string>() { Text = "Nested ChildNode 3"},
                    }
                },
                }
            }
        };
    }

}